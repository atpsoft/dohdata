#!/usr/bin/env ruby
require 'dohutil/app/init_from_pwd'
require 'dohroot/options'
require 'dohutil/config'
require 'dohdata/catalog'
require 'dohdata/require_datagen'
require 'dohlog'
DohData.require_datagen

opts = Doh::Options.new(
{'count' => [1, "-c", "--count <amount>", "how many to create"] \
,'logging' => [false, "-l", "--logging", "enable logging (off by default)"] \
}, true, 'list of catalog entries to create')

if opts.varargs.size == 0
  DohData.catalog_list.each {|elem| puts elem }
  exit
end

opts.varargs.each do |entry|
  klass = DohData.search_catalog(entry)
  if klass.nil?
    puts "unable to find data object matching: #{entry}"
  else
    DohLog.disable unless opts.logging
    opts.count.to_i.times { klass.new.save }
  end
end
